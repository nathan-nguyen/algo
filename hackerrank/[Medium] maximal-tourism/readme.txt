This problem can be solved by using weighted quick union but dfs is better.

